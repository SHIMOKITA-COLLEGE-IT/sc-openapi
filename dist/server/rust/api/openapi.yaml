openapi: 3.1.0
info:
  title: main
  version: "1.0"
servers:
- description: Mock Server
  url: https://stoplight.io/mocks/college-app/college-app/406762
paths:
  /login:
    post:
      description: |
        ## æ¦‚è¦
        accessTokenã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€‚

        åˆæœŸç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ æœªå›ç­”ã®å ´åˆã€Useræƒ…å ±ã‚’å–å¾—ã™ã‚‹ã€‚

        ## ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã‚ˆã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®åˆ†å²

        - 200
          - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«userãŒã‚ã‚‹
            - åˆæœŸç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ã«é·ç§»ã€defaultå€¤ã«userã‚’ä½¿ç”¨
          - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«userãŒãªã„
            - Homeã«é·ç§»
        - 401
          - ã€Œã“ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚‰é‹å–¶ã«å ±å‘Šã—ã¦ã­ã€ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã«é·ç§»
        - 403
          - ã€Œã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã‚‹ã‚ˆã€ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã«é·ç§»
        - 404
          - ã€Œã¾ã é‹å–¶å´ã§ãƒ‡ãƒ¼ã‚¿ç™»éŒ²ãŒå®Œäº†ã—ã¦ã„ãªã„ã‚ˆã€ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã«é·ç§»
      operationId: post-login
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/post_login_request'
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/post_login_200_response'
          description: OK
        "401":
          description: ç„¡åŠ¹ãªfirebaseIdToken
        "403":
          description: Disabledã«ãªã£ã¦ã„ã‚‹ã€ã¤ã¾ã‚ŠBANã•ã‚Œã¦ã„ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
        "404":
          description: |-
            Airtableä¸Šã«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ã¾ã›ã‚“

            å…ˆã«Airtableã§Emailã ã‘ã§ã‚‚ç™»éŒ²ã—ã¦ãã ã•ã„
      summary: Login
  /users:
    get:
      description: å…¨ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—ã™ã‚‹
      operationId: get-users
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/User'
          description: OK
      security:
      - accessToken: []
      summary: Get Users
    put:
      description: Airtableä¸Šã®Useræƒ…å ±ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹
      operationId: put-users
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/put_users_request'
      responses:
        "200":
          description: OK
      security:
      - accessToken: []
      summary: Update User
      x-internal: false
  /users/search:
    get:
      description: |-
        ## TODO

        - [ ] ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        - [ ] ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
      operationId: get-users-search
      parameters:
      - description: æ¤œç´¢ãƒ¯ãƒ¼ãƒ‰
        explode: true
        in: query
        name: query
        required: true
        schema: {}
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/User'
          description: OK
      security:
      - accessToken: []
      summary: Search Users (WIP)
      tags: []
  /users/{recordId}:
    get:
      description: æŒ‡å®šã®userã‚’å–å¾—
      operationId: get-users-recordId
      parameters:
      - explode: false
        in: path
        name: recordId
        required: true
        schema: {}
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: OK
      security:
      - accessToken: []
      summary: Get User
      tags: []
    parameters:
    - explode: false
      in: path
      name: recordId
      required: true
      schema: {}
      style: simple
  /generations:
    get:
      description: æŒ‡å®šã—ãŸtypeã®`Generation`ã‚’å…¨ã¦å–å¾—ã™ã‚‹
      operationId: get-generations
      parameters:
      - explode: true
        in: query
        name: type
        required: true
        schema:
          enum:
          - program
          - house
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/Generation'
          description: OK
      security:
      - accessToken: []
      summary: Get Generations
      tags: []
  /generations/{recordId}:
    get:
      description: æŒ‡å®šã®generationã‚’å–å¾—
      operationId: get-generations-recordId
      parameters:
      - explode: false
        in: path
        name: recordId
        required: true
        schema: {}
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Generation'
          description: OK
      security:
      - accessToken: []
      summary: Get Generation
      tags: []
    parameters:
    - explode: false
      in: path
      name: recordId
      required: true
      schema: {}
      style: simple
  /groups:
    get:
      description: æŒ‡å®šã—ãŸtypeã®`Group`ã‚’å…¨ã¦å–å¾—ã™ã‚‹
      operationId: get-groups
      parameters:
      - explode: true
        in: query
        name: type
        required: false
        schema:
          enum:
          - committee
          - club
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/Group'
          description: OK
      security:
      - accessToken: []
      summary: Get Groups
      tags: []
  /groups/{recordId}:
    get:
      description: æŒ‡å®šã®Groupã‚’å–å¾—
      operationId: get-groups-recordId
      parameters:
      - explode: false
        in: path
        name: recordId
        required: true
        schema: {}
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group'
          description: OK
      security:
      - accessToken: []
      summary: Get Group
      tags: []
    parameters:
    - explode: false
      in: path
      name: recordId
      required: true
      schema: {}
      style: simple
components:
  requestBodies: {}
  schemas:
    User:
      example:
        birthday: ""
        selfIntroductionSlideUrl: ""
        socialLinks: ""
        role: ""
        roomNumber: ""
        photoUrls: ""
        lastModifiedAt: ""
        committees: ""
        bio: ""
        postNumber: ""
        i18n: ""
        pronoun: ""
        imageUrl: ""
        hideAge: ""
        houses: ""
        clubs: ""
        id: ""
        programs: ""
        position: ""
        email: hoge@hlab.college
      properties:
        id:
          description: Airtable's Record ID
        email:
          example: hoge@hlab.college
          format: email
        role:
          enum:
          - resident
          - alumni
          - staff
        i18n:
          items:
            $ref: '#/components/schemas/UserI18n'
        imageUrl:
          format: uri
        pronoun:
          enum:
          - SHE_HER
          - HE_HIM
          - THEY_THEM
        birthday:
          format: date
        hideAge:
          default: false
        socialLinks:
          items:
            $ref: '#/components/schemas/UserSocialLink'
        roomNumber:
          maximum: 599
          minimum: 100
        postNumber:
          maximum: 599
          minimum: 100
        selfIntroductionSlideUrl:
          format: uri
        programs:
          items:
            $ref: '#/components/schemas/Generation'
        houses:
          items:
            $ref: '#/components/schemas/Generation'
        committees:
          items:
            $ref: '#/components/schemas/UserGroupBelonging'
        clubs:
          items:
            $ref: '#/components/schemas/UserGroupBelonging'
        position:
          description: è‚©æ›¸ã
        bio:
          description: Markdown
        photoUrls:
          items:
            format: uri
        lastModifiedAt:
          format: date
      required:
      - email
      - i18n
      - id
      - role
      title: User
      x-stoplight:
        id: 80vqy0i3q5qhd
    UserI18n:
      properties:
        locale:
          enum:
          - ja
          - en
        firstName: {}
        lastName: {}
        phoneticFirstName: {}
        phoneticLastName: {}
        nickName: {}
        middleName: {}
        phoneticMiddleName: {}
        maidenName: {}
        prefix: {}
        suffix: {}
      required:
      - firstName
      - lastName
      - locale
      title: UserI18n
      x-stoplight:
        id: 871f6591b945e
    UserGroupBelonging:
      properties:
        group:
          $ref: '#/components/schemas/Group'
        displayName:
          example: ã‚«ãƒ¬ãƒƒã‚¸ãƒ©ã‚¤ãƒ•åˆ†ç§‘ä¼š (22.04~)
        from:
          format: date
        to:
          format: date
      required:
      - displayName
      - group
      title: UserGroupBelonging
      x-stoplight:
        id: mbwu85j19fka0
    UserSocialLink:
      properties:
        brand:
          $ref: '#/components/schemas/SocialBrand'
        username:
          example: chiji1108
      required:
      - brand
      - username
      title: UserSocialLink
      x-stoplight:
        id: 0f1pz4ffn9owr
    SocialBrand:
      properties:
        id:
          description: Airtable's Record ID
        name:
          example: twitter
        svgIconUrl:
          format: uri
        urlPrefix:
          example: https://twitter.com/
          format: uri
        formPrefix:
          example: '@'
      required:
      - id
      - name
      title: SocialBrand
      x-stoplight:
        id: x5aug333lhdcu
    Group:
      description: "`Committee`, `Club`"
      example:
        createdAt: ""
        archivedAt: ""
        photoUrls: ""
        emoji: ğŸ“š
        displayName: ""
        slackChannel: '#310_coco_collegelife'
        description: ""
        id: ""
        type: ""
        title: ã‚«ãƒ¬ãƒƒã‚¸ãƒ©ã‚¤ãƒ•åˆ†ç§‘ä¼š
      properties:
        id:
          description: Airtable's Record ID
        type:
          enum:
          - committee
          - club
          - project
        displayName:
          default: ã‚«ãƒ¬ãƒƒã‚¸ãƒ©ã‚¤ãƒ•åˆ†ç§‘ä¼š
        createdAt:
          format: date
        archivedAt:
          format: date
        emoji:
          example: ğŸ“š
        title:
          example: ã‚«ãƒ¬ãƒƒã‚¸ãƒ©ã‚¤ãƒ•åˆ†ç§‘ä¼š
        description:
          description: Markdown
        slackChannel:
          example: '#310_coco_collegelife'
        photoUrls:
          items:
            format: uri
      required:
      - displayName
      - id
      - type
      title: Group
      x-stoplight:
        id: i4tun9gkx8vpc
    Generation:
      description: "`Program`, `House/Home`"
      example:
        photoUrls: ""
        displayName: RP2æœŸç”Ÿ
        coverImageUrl: ""
        description: ""
        from: ""
        id: ""
        to: ""
        type: ""
        title: Residential Program 2æœŸç”Ÿ
      properties:
        id:
          description: Airtable's Record ID
        type:
          enum:
          - program
          - house
        displayName:
          example: RP2æœŸç”Ÿ
        from:
          format: date
        to:
          format: date
        coverImageUrl:
          format: uri
        title:
          example: Residential Program 2æœŸç”Ÿ
        description:
          description: Markdown
        photoUrls:
          items:
            format: uri
      required:
      - displayName
      - id
      - type
      title: Generation
      x-stoplight:
        id: rd01g8hw4cdca
    post_login_request:
      properties:
        firebaseIdToken:
          description: |
            å–å¾—æ–¹æ³•ã¯[ã“ã¡ã‚‰](https://firebase.google.com/docs/auth/admin/verify-id-tokens#retrieve_id_tokens_on_clients)
      required:
      - firebaseIdToken
    post_login_200_response:
      example:
        accessToken: ""
        user:
          birthday: ""
          selfIntroductionSlideUrl: ""
          socialLinks: ""
          role: ""
          roomNumber: ""
          photoUrls: ""
          lastModifiedAt: ""
          committees: ""
          bio: ""
          postNumber: ""
          i18n: ""
          pronoun: ""
          imageUrl: ""
          hideAge: ""
          houses: ""
          clubs: ""
          id: ""
          programs: ""
          position: ""
          email: hoge@hlab.college
      properties:
        accessToken: {}
        user:
          $ref: '#/components/schemas/User'
      required:
      - accessToken
    put_users_request:
      properties:
        i18n:
          items:
            $ref: '#/components/schemas/UserI18n'
        imageUrl:
          format: uri
        pronoun:
          enum:
          - SHE_HER
          - HE_HIM
          - THEY_THEM
        birthday:
          format: date
        hideAge:
          default: false
        socialLinks:
          items:
            properties:
              brandId:
                description: Airtable's Social Brand Record ID
              username: {}
            required:
            - brandId
            - username
        roomNumber:
          maximum: 599
          minimum: 100
        postNumber:
          maximum: 599
          minimum: 100
        selfIntroductionSlideUrl:
          format: uri
        programs:
          items:
            properties:
              generationId:
                description: Airtable's Generation Record ID
            required:
            - generationId
        houses:
          items:
            properties:
              generationId:
                description: Airtable's Generation Record ID
            required:
            - generationId
        committees:
          items:
            properties:
              groupId:
                description: Airtable's Group Record ID
              from:
                format: date
              to:
                format: date
            required:
            - groupId
        clubs:
          items:
            properties:
              groupId:
                description: Airtable's Group Record ID
              from:
                format: date
              to:
                format: date
            required:
            - groupId
        position:
          description: è‚©æ›¸ã
        bio:
          description: Markdown
        photoUrls:
          items:
            format: uri
  securitySchemes:
    accessToken:
      description: |-
        `Authrization: Bearer <accessToken>`

        `accessToken`ã¯`/login`ã§å–å¾—ã™ã‚‹ã€‚
      scheme: bearer
      type: http
x-stoplight:
  id: h57ut1i2gjak8

